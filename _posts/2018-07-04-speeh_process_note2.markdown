---
layout:     post
title:      "现代语音信号处理笔记 (二)"
subtitle:   "时域分析与短时傅里叶分析"
date:       2018-07-04 00:15:18
author:     "Pelhans"
header-img: "img/speech_process.jpg"
header-mask: 0.3 
catalog:    true
tags:
    - Linux
---


> 本节针对《现代语音信号处理》这本书的第三章与第四章，即时域分析和短时傅里叶分析两章。 

* TOC
{:toc}

# 时域分析


根据语音分析的参数的不同，语音信号分析分为时域、频域、倒谱域、时频域、小波域、高阶累积量域等方法。时域分析具有简单、运算量小、物理意义明确等有点；但更为有效的分析**大多围绕频域进行，因为语音中最重要的感知特性反映在其功率谱中**，而相位变化只起到很小作用。另一方面，按照语音学观点，可将语音特征的表示和提取分为模型分析和非模型分析两种。模型分析是一句语音产生的数学模型，分析和提取其模型的特征参数，包括共振峰模型法以及声管模型即LPC等。不进行模型分析的其他方法属于非模型法，时域、频域以及同态分析等。

贯穿语音分析全过程的是短时分析技术。因为语音信号特性随时间变化是非平稳随机过程，因此**语音信号具有时变特性，但短时间内其特性却基本不变，具备短时平稳性**。在此基础上，对语音信号流进行分段处理，即帧。语音通常在10~30 ms内保持相对平稳，因而帧长一般取10~30 ms。

## 数字化和预处理

为了将模拟语音信号转化为数字信号，需要经过**取样和量化**两个步骤，以得到时间和幅度均离散的信号。

**取样是将时间上连续的信号离散化为样本序列，根据奈奎斯特采样定理，取样频率大于信号两倍宽度时，取样过程不会丢失信息，且取样信号可精确地重构原信号**。若不满足取样定理，将产生频谱混叠，此时信号中的高频成分将产生失真。

取样后需要对信号进行**量化，即将时间上离散而幅度仍然连续的波形再离散化**。其过程是将整个幅度值分割为有限个区间，将落入同一区间的样本赋予相同的幅度值。若量化阶梯选择的足够小(如64)，则信号幅度从一个取样值到相邻取样值的变化可能非常大，常跨越很多量化阶梯。这样产生的量化噪声接近平稳白噪声过程。一般而言，8bit时的噪声自相关函数几乎为冲激函数，与白噪声的过程相一致。

若用$\sigma_{x}^{2}$表示语音信号方差，$X_max$表示信号峰值，B表示量化字长，$\sigma_{e}^{2}$表示噪声方差，则可证明量化信噪比(信号与量化噪声的功率之比)为：

$$ SNR(dB) = 10lg(\frac{\sigma^{2}_{x}}{\sigma^{2}_{e}}) = 6.02B + 4.77 - 20lg(\frac{X_{max}}{\sigma_{x}}) $$

假设信号服从Laplacian分布，此时信号幅度超过$4\sigma_x$的概率很小，因此上式可简化为：

$$ SNR(dB) = 6.02B - 7.2 $$

上式表明，量化器中每比特字长对SNR贡献为6dB，结合研究表明，语音信号的波形动态范围可达55dB，因此**B应该取10以上**。

更进一步分析前有时还需要进行其他的预处理，包括放大及增益控制、反混叠滤波(有良好截止特性的模拟低通滤波器对信号进行滤波)、预加重等，对有语音输出的场合还需要进行D/A 变换和起平滑作用的低通滤波。具体流程如下图所示：

![](/img/in-post/speech_process_note2/speech_process_note2_1.png)

## 短时能量分析

对语音信号短时分析，信号刘用分段或分帧实现。分帧可用移动的有限长窗口加权来实现。窗每次移动的距离如窗宽度相同，则各帧信号相互衔接，若移动距离比窗宽小，则邻帧间有部分重叠。

不同的窗口选择(形状、长度)将决定短时能量的特性。**应选择合适的窗口，使得平均能量更好的反应语音信号的幅度变化**。常用的窗口如直角窗、Hamming窗、Hanning窗、Blackman窗、Kaiser窗等均为对称形状的窗口。下面主要介绍一下最常用的直角窗和Hamming窗。

首先给出短时平均能量的定义：

$$ E_{n} = \Sigma_{m=-\infty}^{\infty}[x(m)w(n-m)]^{2} = \Sigma_{m=n-N+1}^{n}[x(m)w(n-m)]^{2} $$

E(n)为语音信号一个短时间段内的能量，且以n为标志。其中w(n)是窗函数,x(m)表示语音信号，N为窗口内采样的总数(不确定，书上公式各变量含义完全没给)。下图给出短时平均能量计算的说明：

![](/img/in-post/speech_process_note2/speech_process_note2_2.png)

进一步整理，上式可改写为：

$$ E_{n} = \Sigma_{m=-\infty}^{\infty} x^{2}(m)h(n-m) = x^{2}(n)*h(n) $$ 

其中：

$$ h(n) = w^{2}(n) $$

上式表明，**短时平均能量相当于语音信号的平方通过单位函数响应为h(n)的线性滤波器的输出**。

### 直角窗

$$ h(n) = \left(
\begin{aligned}
1, & ~~0 \le n \le N-1 \\
0, & ~~其他 
\end{aligned}
\right)
$$

相应数字滤波器的频率特性为：

$$H(e^{jwT}) = \Sigma_{n=0}^{N-1}e^{-jwT} = \frac{sin(NwT/2)}{sin(w/2)}e^{-jwT(N-1)/2} $$

具有线性相频特性。

### Hamming 窗

$$ h(n) = \left(
\begin{aligned}
0.54-0.46 cos[2\pi n/(N-1)], & ~~0\le n \le N-1 \\
0, & ~~ 其他
\end{aligned}
\right)
$$

下图给出直角窗和Hamming窗的对数幅频特性，可见**Hamming窗的第一个零频率位置比直角窗大1倍左右，即带宽增加1倍。同时带外衰减也比直角窗大得多。直角窗谱平滑效果较好，但细节丢失，Hamming窗则相反**。对于窗宽则是相对语音信号基音周期而言的。在10kHz采样率下，通常折中选取100~200，对应帧长10~20 ms。当N过小时，短时平均能量函数波形起伏较快，过大时波形变化缓慢，因此选择合适的N值很重要。

![](/img/in-post/speech_process_note2/speech_process_note2_3.png)

## 短时过零分析


